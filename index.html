<!DOCTYPE html>
<html>

<head>
   <title>Shopping Cart</title>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
   <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css" rel="stylesheet" />
   <link href="style.css" rel="stylesheet">
</head>

<body>

   <section>
      <div class="container">
         <div class="cart">
            <div class="col-md-12 col-lg-10 mx-auto">
               <div class="cart-item">
                  <div class="row">
                     <div class="col-md-7 center-item">
                        <img src="images/product-1.png" alt="">
                        <h5>iPhone 11 128GB Black</h5>
                     </div>

                     <div class="col-md-5 center-item">
                        <div class="input-group number-spinner">
                           <button class="btn btn-default btnminus"><i class="fas fa-minus "></i></button>
                           <input type="text" class="form-control text-center" value="1">
                           <button class="btn btn-default btnplus"><i class="fas fa-plus "></i></button>
                        </div>
                        <h5>$<span class="price">1,500</span><span class="prices"></span></h5>
                        <img src="images/remove.png" alt="" class="remove-item">
                     </div>
                  </div>
               </div>

               <div class="cart-item">
                  <div class="row">
                     <div class="col-md-7 center-item">
                        <img src="images/product-1.png" alt="">
                        <h5>iPhone 11 128GB Black</h5>
                     </div>

                     <div class="col-md-5 center-item">
                        <div class="input-group number-spinner">
                           <button class="btn btn-default btnminus"><i class="fas fa-minus "></i></button>
                           <input type="text" class="form-control text-center" value="1">
                           <button class="btn btn-default btnplus"><i class="fas fa-plus "></i></button>
                        </div>
                        <h5>$<span class="price">1,500</span><span class="prices"></span></h5>
                        <img src="images/remove.png" alt="" class="remove-item">
                     </div>
                  </div>
               </div>


               <div class="cart-item">
                  <div class="row">
                     <div class="col-md-7 center-item mx-auto">
                        <img src="images/product-2.png" alt="">
                        <h5>iPhone 11 Silicone Case - Black</h5>
                     </div>
                     <div class="col-md-5 center-item">
                        <div class="input-group number-spinner">
                           <button class="btn btn-default btnminus"><i class="fas fa-minus "></i></button>
                           <input type="text" class="form-control text-center" value="1">
                           <button class="btn btn-default btnplus"><i class="fas fa-plus"></i></button>

                        </div>
                        <h5>$<span class="price">59</span><span class="prices"></span></h5>
                        <img src="images/remove.png" alt="" class="remove-item">
                     </div>
                  </div>
               </div>
               <div class="cart-item">
                  <div class="row">
                     <div class="col-md-7 center-item mx-auto">
                        <img src="images/product-2.png" alt="">
                        <h5>iPhone 11 Silicone Case - Black</h5>
                     </div>
                     <div class="col-md-5 center-item">
                        <div class="input-group number-spinner">
                           <button class="btn btn-default btnminus"><i class="fas fa-minus "></i></button>
                           <input type="text" class="form-control text-center" value="1">
                           <button class="btn btn-default btnplus"><i class="fas fa-plus"></i></button>

                        </div>
                        <h5>$<span class="price">59</span><span class="prices"></span></h5>
                        <img src="images/remove.png" alt="" class="remove-item">
                     </div>
                  </div>
               </div>

               <div class="cart-item">
                  <div class="row">

                     <div class="col-md-8">
                        <h5 >Subtotal: </h5>
                        <h5 >Tax:</h5>
                        <h5 >Total:</h5>
                     </div>

                     <div class="col-md-4 status">
                        <h5>$<span class="subtotal">0</span></h5>
                        <h5>$ <span class="tax">0</span> </h5>
                        <h5>$<span class="total">0</span></h5>
                     </div>
                  </div>
               </div>
               <div class="col-md-12 pt-4 pb-4">
                  <button type="button" class="btn btn-success check-out">Check Out</button>
               </div>
            </div>
         </div>
      </div>
   </section>
   <script>
      const btns=document.querySelectorAll(".btn");
      let subtotal=document.querySelector(".subtotal");
      const subtotalWithoutComma=subtotal.innerText.replace(",","");
      let subtotalnum=parseFloat(subtotalWithoutComma);

     
      window.addEventListener("load",function(){
         const prices=document.querySelectorAll(".price");
         prices.forEach(function(price){
               const pricewithoutcomma=price.innerText.replace(",","");
               iniprice=parseFloat(pricewithoutcomma);
               subtotalnum+=iniprice;
         
      });

      const subtotalwithcomma=thousands_separators( subtotalnum);
      document.querySelector(".subtotal").innerText=subtotalwithcomma;
      finalcal(subtotalnum);
      
      });

      const tax=document.querySelector(".tax");
            let taxnumber=parseFloat(tax.innerText);
            const total=document.querySelector(".total");
            const totalwithoutcomma=total.innerText.replace(",","");
            let totalnumber=parseFloat(totalwithoutcomma);

      btns.forEach(function(btn){
         btn.addEventListener("click",function(e){

            let amount=0;
            let minusamount=0; 
            
           

            let price=e.currentTarget.parentElement.nextElementSibling.childNodes[1];
            const pricewithoutcomma=price.innerText.replace(",","");
            let pricenumber=parseFloat(pricewithoutcomma);
            price.style.display="none";
            
            const btnClass = e.currentTarget.classList;
            
            if(btnClass.contains("btnplus")){

               let plus=e.currentTarget.previousElementSibling.value;
               let plusnumber=parseFloat(plus);
               plusnumber++;
               e.currentTarget.previousElementSibling.value=plusnumber; 
              

               amount=pricenumber*plusnumber;
               const amountcomma=thousands_separators(amount);
               e.currentTarget.parentElement.nextElementSibling.lastChild.innerText= amountcomma;
               subtotalnum+=pricenumber;
               const subtotalcomma=thousands_separators(subtotalnum)
               document.querySelector(".subtotal").innerText=subtotalcomma;


            finalcal(subtotalnum);

            }
             
            if(btnClass.contains("btnminus")){
               const minus=e.currentTarget.nextElementSibling.value;
               
               let minusnumber=parseFloat(minus);
                minusnumber--;
                console.log(minusnumber);
       
               if(minusnumber>=1){
                  e.currentTarget.nextElementSibling.value=minusnumber;

                  
                 

                         minusamount=minusnumber*pricenumber;
              
               if(minusamount>0){
                  const minusamountcomma=thousands_separators(minusamount);
                  e.currentTarget.parentElement.nextElementSibling.lastChild.innerText= minusamountcomma;

               }                
               subtotalnum-=pricenumber;
               const subtotalcomma=thousands_separators(subtotalnum);
               document.querySelector(".subtotal").innerText=subtotalcomma;
           
                   finalcal(subtotalnum);
                  
               }
               else{
                 minusamount=minusnumber*pricenumber;
                 const pricenumbercomma=thousands_separators(pricenumber);
                 e.currentTarget.parentElement.nextElementSibling.lastChild.innerText= pricenumbercomma;
                  
                 e.currentTarget.disabled=true;
                 
               }

               e.currentTarget.disabled=false;

            }
            
            
          
           
         });
      });

      let subtotalval=0;
       
      const removeitems=document.querySelectorAll(".remove-item");

            removeitems.forEach(function(removeitem){
               removeitem.addEventListener("click",function(e){
                  
                  e.currentTarget.parentElement.parentElement.parentElement.style.display="none";

                  const initialamount= e.currentTarget.previousElementSibling.childNodes[1].innerText;
                  const initialamountwithoutcomma=initialamount.replace(",","");
                  const initialamountnum=parseFloat(initialamountwithoutcomma);
                  

                  const secondamount= e.currentTarget.previousElementSibling.childNodes[2].innerText;
                  const secondamountwithoutcomma= secondamount.replace(",","");
                  const secondamountnum=parseFloat(secondamountwithoutcomma);
                

                  const subvalue=document.querySelector(".subtotal").innerText;
                  const subvaluewithoutcomma=subvalue.replace(",","");
                  const subvaluenum=parseFloat(subvaluewithoutcomma);

                  
                 

                  if(isNaN(secondamountnum)){
                     subtotalval= initialamountnum; 
                  }else{
                     subtotalval=secondamountnum; 
                  }

                 let final=subvaluenum-subtotalval;
                 let finalcomma=thousands_separators(final);
                 document.querySelector(".subtotal").innerText=finalcomma;
                 

                 finalcal(final);


               });
            });

            function finalcal(tax){
               taxnumber=tax*.1;
              document.querySelector(".tax").innerText=Math.round(taxnumber);
            
              totalnumber=tax+taxnumber;
              const totalnumbercomma=thousands_separators(Math.round(totalnumber));
              document.querySelector(".total").innerText=totalnumbercomma;

            }
            function thousands_separators(num)
             {
                   var num_parts = num.toString().split(".");
                   num_parts[0] = num_parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                   return num_parts.join(".");
  }
   </script>
</body>

</html>